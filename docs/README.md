# vrControlGUI Documentation

## Overview

The vrControlGUI is a MATLAB App Designer application that serves as the configuration interface for virtual reality (VR) behavioral experiments on linear tracks. It provides researchers with comprehensive control over experimental parameters, from environment selection to complex behavioral requirements.

## Notes on AI Usage
Everything in this documentation was generated by AI, except for this section on "Notes on AI Usage". I requested that Claude-4-Sonnet do the following:
```markdown
I'd like you to develop a comprehensive documentation system for the @vrControlGUI.m app. Please do it in a multistep process: 
--
first, read through the code and describe what it does and how it works in a markdown file in the docs/ folder called "notes.md". This is a first pass for you to digest it. 
second, think carefully and analyze the logic of how things work from the users perspective. 
--
Carefully describe the systems for designing an experiment, categorize the different things including: 
vrEnv selection (both at the options and at the inUse level). 
vrEnv properties (envSettings menu). 
trial types (both when linked to env and not)
- explain how it works when not linked to an env
- then explain how you can link it to each env -- it works the same except now the env selection corresponds to the current gui values of trial type
Initial block, block structure
ITI
--
Then, write a documentation system that explains the code from a DX perspective -- it's sort of like code/programmers documentation but in a nice markdown system also in docs. 
-- 
Once you've done all this, then please write a documentation system for a user who hasn't used it and isn't good at matlab. Use references to the DX code where needed, but focus on big picture actions and needs, like "want to do this? Here's how"
```

Keep that in mind as you read!


## Documentation Structure

This documentation system is organized into four complementary documents:

### üìù [notes.md](./notes.md)
**Initial code analysis and technical overview**
- High-level architecture description
- Core functionality breakdown
- Key components and their relationships
- Technical implementation details

### üß† [user-logic-analysis.md](./user-logic-analysis.md) 
**User perspective and workflow analysis**
- Experimental design workflow from user's viewpoint
- Detailed explanation of VR environment selection system
- Trial type system modes and their applications
- Block structure and timing controls
- Common user workflows and decision points

### üë®‚Äçüíª [developer-documentation.md](./developer-documentation.md)
**Code architecture and implementation details**
- Core data structures and their organization
- Key methods and their responsibilities
- GUI state management patterns
- Integration points with external systems
- Extension points for future development

### üìñ [user-guide.md](./user-guide.md)
**Practical user manual for researchers**
- Step-by-step setup instructions
- Interface explanation with screenshots concepts
- Common workflows for different experiment types
- Best practices and troubleshooting
- Advanced features and tips

## Quick Navigation

### For New Users
Start with the **[User Guide](./user-guide.md)** for practical, step-by-step instructions on setting up and running experiments.

### For Researchers Designing Experiments
Read the **[User Logic Analysis](./user-logic-analysis.md)** to understand the experimental design philosophy and decision-making process.

### For Developers and Advanced Users
Consult the **[Developer Documentation](./developer-documentation.md)** for technical details about the code architecture and implementation.

### For Technical Overview
See **[Notes](./notes.md)** for a comprehensive technical analysis of the codebase.

## Key Features

### Environment Management
- Load and validate VR environment directories
- Configure environment properties (length, reward zones, etc.)
- Flexible environment selection and ordering

### Trial Type System
- **Independent Mode**: Same behavioral requirements across all environments
- **Environment-Linked Mode**: Different requirements per environment
- Support for conditional trial types with multiple behavioral parameters

### Block Structure Control
- **Initial Blocks**: Single-environment habituation periods
- **Preset Blocks**: Fixed trial counts per environment
- **Random Blocks**: Variable block lengths with statistical control

### Behavioral Requirements
- Reward probability control (fixed, random, or conditional)
- Active licking requirements (with hardware detection)
- Active stopping requirements with configurable durations
- Movement gain scaling for speed control

### Timing and Session Management
- Flexible intertrial interval control
- Session duration and trial count limits
- Persistent settings storage and loading
- Integration with hardware-specific parameters

## System Requirements

- MATLAB with App Designer
- Compatible VR environment files (.tif format)
- Optional: Lick encoder hardware for active licking experiments
- Integration with vrControl experiment execution system

## Getting Started

1. **Installation**: Ensure vrControlGUI.m is in your MATLAB path
2. **Setup**: Configure `rigParameters()` for your hardware setup
3. **First Use**: Follow the Quick Start Guide in the [User Guide](./user-guide.md)
4. **Advanced Use**: Explore complex experimental designs using the workflow examples

## Architecture Highlights

### Data Flow
```
VR Directory ‚Üí Environment Loading ‚Üí Property Configuration ‚Üí 
Trial Type Design ‚Üí Block Structure ‚Üí Settings Generation ‚Üí 
Experiment Execution
```

### Key Design Patterns
- **State-dependent UI**: Components enable/disable based on configuration choices
- **Hierarchical settings**: Global ‚Üí Environment-specific ‚Üí Trial-specific parameters
- **Real-time validation**: Immediate feedback on invalid configurations
- **Persistent storage**: Save and reload complete experimental configurations

### Integration Points
- **rigParameters()**: Hardware-specific configuration
- **createTrialStructure()**: Convert settings to trial sequences  
- **runExperiment()**: Execute configured experiments
- **persistentVariables()**: Session-to-session data persistence

## Common Use Cases

### Basic Research Applications
- **Environment Comparison**: Test animal responses to different visual environments
- **Reward Learning**: Study how animals adapt to different reward contingencies
- **Behavioral Flexibility**: Examine adaptation to changing environmental demands

### Advanced Research Applications
- **Context-Dependent Learning**: Different behavioral rules in different environments
- **Probabilistic Reward Schedules**: Complex reward probability structures
- **Multi-Parameter Experiments**: Simultaneous manipulation of multiple behavioral variables

## Support and Extension

### Troubleshooting
Common issues and solutions are covered in the [User Guide](./user-guide.md) troubleshooting section.

### Extending Functionality
The [Developer Documentation](./developer-documentation.md) includes extension points for:
- Adding new trial type properties
- Implementing new block structure types
- Integrating additional hardware components

### Best Practices
- Start with simple configurations and add complexity gradually
- Always preview experiments before running
- Save successful configurations for reuse
- Validate hardware compatibility before complex experiments

## Version Information

This documentation corresponds to the vrControlGUI implementation as of the current codebase analysis. For updates and changes, refer to the version control history and update documentation accordingly.

---

*This documentation system provides comprehensive coverage of the vrControlGUI from multiple perspectives, ensuring that users, researchers, and developers can effectively understand and utilize this powerful experimental configuration tool.*
